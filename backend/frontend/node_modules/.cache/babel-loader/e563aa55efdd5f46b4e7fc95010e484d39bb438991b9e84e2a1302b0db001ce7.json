{"ast":null,"code":"import _objectSpread from\"D:/Test-app/User-auth-app/backend/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{Link,useNavigate}from'react-router-dom';import{ToastContainer}from'react-toastify';import{handleError,handleSuccess}from'../utlis';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){// ======================= STATE =======================\nconst[loginInfo,setLoginInfo]=useState({email:'',password:''});const navigate=useNavigate();// ======================= HANDLE INPUT CHANGE =======================\nconst handleChange=e=>{const{name,value}=e.target;setLoginInfo(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));};// ======================= HANDLE LOGIN =======================\nconst handleLogin=async e=>{e.preventDefault();const{email,password}=loginInfo;// 1. Validate required fields\nif(!email||!password){return handleError('Email and password are required');}try{// 2. API request\nconst response=await fetch(\"http://localhost:5000/auth/login\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(loginInfo)});const result=await response.json();console.log(\"API raw result:\",result);// 3. Extract expected fields from backend response\nconst{message,token,user}=result;if(message===\"Login successful\"){handleSuccess(message);localStorage.setItem('token',token);if(user!==null&&user!==void 0&&user.name){localStorage.setItem(\"loggedInUser\",JSON.stringify(user));// ✅ stringify the object\n}// ✅ Redirect after 1 second\nsetTimeout(()=>{console.log(\"Login successful, navigating to /home...\");navigate(\"/home\");},1000);}else{handleError(message||\"Login failed\");}}catch(err){console.error(\"Login error:\",err);handleError(\"Something went wrong. Please try again later.\");}};// ======================= JSX =======================\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"Container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleLogin,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{onChange:handleChange,type:\"email\",name:\"email\",placeholder:\"Enter your email...\",value:loginInfo.email})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{onChange:handleChange,type:\"password\",name:\"password\",placeholder:\"Enter your Password...\",value:loginInfo.password})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Login\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Don\\u2019t have an account? \",/*#__PURE__*/_jsx(Link,{to:\"/signup\",children:\"Signup\"})]})]}),/*#__PURE__*/_jsx(ToastContainer,{})]});}export default Login;","map":{"version":3,"names":["React","useState","Link","useNavigate","ToastContainer","handleError","handleSuccess","jsx","_jsx","jsxs","_jsxs","Login","loginInfo","setLoginInfo","email","password","navigate","handleChange","e","name","value","target","prev","_objectSpread","handleLogin","preventDefault","response","fetch","method","headers","body","JSON","stringify","result","json","console","log","message","token","user","localStorage","setItem","setTimeout","err","error","className","children","onSubmit","htmlFor","onChange","type","placeholder","to"],"sources":["D:/Test-app/User-auth-app/backend/frontend/src/pages/Login.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { ToastContainer } from 'react-toastify';\r\nimport { handleError, handleSuccess } from '../utlis';\r\n\r\nfunction Login() {\r\n  // ======================= STATE =======================\r\n  const [loginInfo, setLoginInfo] = useState({\r\n    email: '',\r\n    password: '',\r\n  });\r\n\r\n  const navigate = useNavigate();\r\n\r\n  // ======================= HANDLE INPUT CHANGE =======================\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setLoginInfo((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  // ======================= HANDLE LOGIN =======================\r\n  const handleLogin = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const { email, password } = loginInfo;\r\n\r\n    // 1. Validate required fields\r\n    if (!email || !password) {\r\n      return handleError('Email and password are required');\r\n    }\r\n\r\n    try {\r\n      // 2. API request\r\n      const response = await fetch(\"http://localhost:5000/auth/login\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(loginInfo),\r\n      });\r\n\r\n      const result = await response.json();\r\n      console.log(\"API raw result:\", result);\r\n\r\n      // 3. Extract expected fields from backend response\r\n      const { message, token, user } = result;\r\n\r\n      if (message === \"Login successful\") {\r\n        handleSuccess(message);\r\n       localStorage.setItem('token', token);\r\n      \r\nif (user?.name) {\r\n  localStorage.setItem(\"loggedInUser\", JSON.stringify(user)); // ✅ stringify the object\r\n}\r\n\r\n        // ✅ Redirect after 1 second\r\n        setTimeout(() => {\r\n          console.log(\"Login successful, navigating to /home...\");\r\n          navigate(\"/home\");\r\n        }, 1000);\r\n      } else {\r\n        handleError(message || \"Login failed\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Login error:\", err);\r\n      handleError(\"Something went wrong. Please try again later.\");\r\n    }\r\n  };\r\n\r\n  // ======================= JSX =======================\r\n  return (\r\n    <div className=\"Container\">\r\n      <h1>Login</h1>\r\n      <form onSubmit={handleLogin}>\r\n        <div>\r\n          <label htmlFor=\"email\">Email</label>\r\n          <input\r\n            onChange={handleChange}\r\n            type=\"email\"\r\n            name=\"email\"\r\n            placeholder=\"Enter your email...\"\r\n            value={loginInfo.email}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label htmlFor=\"password\">Password</label>\r\n          <input\r\n            onChange={handleChange}\r\n            type=\"password\"\r\n            name=\"password\"\r\n            placeholder=\"Enter your Password...\"\r\n            value={loginInfo.password}\r\n          />\r\n        </div>\r\n\r\n        <button type=\"submit\">Login</button>\r\n        <span>\r\n          Don’t have an account? <Link to=\"/signup\">Signup</Link>\r\n        </span>\r\n      </form>\r\n      <ToastContainer />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}